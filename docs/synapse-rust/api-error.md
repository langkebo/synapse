# APIæµ‹è¯•å¤±è´¥è®°å½•

> **æ›´æ–°æ—¶é—´**: 2026-02-06 17:00:00
> **æœåŠ¡åœ°å€**: http://localhost:8008

---

## ğŸ“Š æµ‹è¯•ç»Ÿè®¡æ€»è§ˆ

| ç« èŠ‚ | æµ‹è¯•èŒƒå›´ | æ€»æ•° | é€šè¿‡ | å¤±è´¥ | é€šè¿‡ç‡ |
|------|---------|------|------|------|--------|
| 3.1 | å®¢æˆ·ç«¯API | 52 | 48 | 4 | 92% |
| 3.2 | ç®¡ç†å‘˜API | 26 | 24 | 2 | 92% |
| 3.3 | è”é‚¦é€šä¿¡API | 30 | 24 | 6 | 80% |
| 3.4 | ç«¯åˆ°ç«¯åŠ å¯†API | 6 | 5 | 1 | 83% |
| 3.5 | è¯­éŸ³æ¶ˆæ¯API | 7 | 5 | 2 | 83% |
| 3.6 | å¥½å‹ç³»ç»ŸAPI | 16 | 13 | 3 | 81% |
| 3.7 | åª’ä½“æ–‡ä»¶API | 8 | 1 | 7 | 12.5% |
| 3.8 | ç§èŠå¢å¼ºAPI | 15 | 10 | 5 | 67% |
| 3.9 | å¯†é’¥å¤‡ä»½API | 10 | 9 | 1 | 90% |
| **æ€»è®¡** | | **170** | **139** | **31** | **82%** |

---

## âœ… å·²ä¿®å¤é—®é¢˜

| é—®é¢˜ | ç« èŠ‚ | çŠ¶æ€ | ä¿®å¤æ—¥æœŸ |
|------|------|------|----------|
| ç®¡ç†å‘˜APIå­—æ®µå‘½å(ip/ip_address) | 3.2.18-19 | âœ… å·²ä¿®å¤ | 2026-02-06 |
| blocked_usersè¡¨ç¼ºå¤± | 3.6.8 | âœ… å·²ä¿®å¤ | 2026-02-06 |
| è¯­éŸ³æ¶ˆæ¯å­—æ®µç±»å‹ä¸åŒ¹é… | 3.7.x | âœ… å·²ä¿®å¤ | 2026-02-06 |
| megolm_sessionsè¡¨ç¼ºå¤± | 3.4.x | âœ… å·²ä¿®å¤ | 2026-02-06 |
| åª’ä½“å­˜å‚¨è·¯å¾„é…ç½® | 3.7.1-2 | âš ï¸ å·²é…ç½® | 2026-02-06 |

---

## âŒ å¾…ä¿®å¤å¤±è´¥æµ‹è¯• (å…±31ä¸ª)

### 3.1 å®¢æˆ·ç«¯API (4ä¸ªå¤±è´¥)

| # | APIç«¯ç‚¹ | é”™è¯¯ç  | åŸå› åˆ†æ |
|---|---------|--------|----------|
| 3.1.4-32 | `DELETE /_matrix/client/r0/directory/room/{room_id}` | M_FORBIDDEN | éœ€è¦ç®¡ç†å‘˜æƒé™ |
| 3.1.4-33 | `POST /_matrix/client/r0/directory/room` | 405 | æˆ¿é—´åˆ«åå·²å­˜åœ¨ï¼Œæ–¹æ³•ä¸å…è®¸ |
| 3.1.7-5 | `POST /_matrix/client/r0/rooms/{room_id}/receipt/{receipt_type}/{event_id}` | M_UNKNOWN | æ•°æ®åº“è¡¨ç»“æ„é—®é¢˜ |
| 3.1.7-6 | `POST /_matrix/client/r0/rooms/{room_id}/read_markers` | M_UNKNOWN | æ•°æ®åº“è¡¨ç»“æ„é—®é¢˜ |

### 3.2 ç®¡ç†å‘˜API (2ä¸ªå¤±è´¥)

| # | APIç«¯ç‚¹ | é”™è¯¯ç  | åŸå› åˆ†æ |
|---|---------|--------|----------|
| 3.2.18 | `POST /_synapse/admin/v1/security/ip/block` | 500 | âœ… å·²ä¿®å¤ï¼šå­—æ®µå‘½åé—®é¢˜ |
| 3.2.19 | `DELETE /_synapse/admin/v1/security/ip/unblock` | 500 | âœ… å·²ä¿®å¤ï¼šå­—æ®µå‘½åé—®é¢˜ |

> âš ï¸ ä»¥ä¸Š2ä¸ªé—®é¢˜å·²ä¿®å¤ï¼Œå¾…é‡æ–°æµ‹è¯•éªŒè¯

### 3.3 è”é‚¦é€šä¿¡API (6ä¸ªå¤±è´¥)

| # | APIç«¯ç‚¹ | é”™è¯¯ç  | åŸå› åˆ†æ |
|---|---------|--------|----------|
| 3.3.1-2 | `GET /_matrix/federation/v1/version` | 404 | è”é‚¦APIæœªå¯ç”¨ |
| 3.3.2-1 | `GET /_matrix/federation/v1/query/destination` | 404 | è”é‚¦APIæœªå¯ç”¨ |
| 3.3.3-1 | `GET /_matrix/federation/v1/get_groups_entities/{group_id}` | 404 | CommunitiesåŠŸèƒ½æœªå®ç° |
| 3.3.4-1 | `GET /_matrix/federation/v1/room/{room_id}/{event_id}` | 404 | è”é‚¦APIæœªå¯ç”¨ |
| 3.3.5-1 | `POST /_matrix/federation/v1/send_join/{room_id}/{event_id}` | 404 | è”é‚¦APIæœªå¯ç”¨ |
| 3.3.6-1 | `GET /_matrix/federation/v1/make_join/{room_id}/{user_id}` | 404 | è”é‚¦APIæœªå¯ç”¨ |

> ğŸ“ **è¯´æ˜**: è”é‚¦APIéœ€è¦å•ç‹¬çš„æœåŠ¡å®ä¾‹ï¼Œå½“å‰æœªå¯ç”¨

### 3.4 ç«¯åˆ°ç«¯åŠ å¯†API (1ä¸ªå¤±è´¥)

| # | APIç«¯ç‚¹ | é”™è¯¯ç  | åŸå› åˆ†æ |
|---|---------|--------|----------|
| 3.4.6 | `GET /rooms/{room_id}/keys/distribution` | 500 | âœ… å·²ä¿®å¤ï¼šmegolm_sessionsè¡¨å·²åˆ›å»º |

> âš ï¸ å¾…é‡æ–°æµ‹è¯•éªŒè¯

### 3.5 è¯­éŸ³æ¶ˆæ¯API (2ä¸ªå¤±è´¥)

| # | APIç«¯ç‚¹ | é”™è¯¯ç  | åŸå› åˆ†æ |
|---|---------|--------|----------|
| 3.5.1 | `POST /_matrix/client/r0/voice/upload` | 500 | âœ… å·²ä¿®å¤ï¼šå­—æ®µç±»å‹å·²æ›´æ–° |
| 3.5.2 | `GET /_matrix/client/r0/voice/{message_id}` | 404 | è¯­éŸ³æ¶ˆæ¯æœªæ‰¾åˆ° |

> âš ï¸ 3.5.1 å¾…é‡æ–°æµ‹è¯•éªŒè¯

### 3.6 å¥½å‹ç³»ç»ŸAPI (3ä¸ªå¤±è´¥)

| # | APIç«¯ç‚¹ | é”™è¯¯ç  | åŸå› åˆ†æ |
|---|---------|--------|----------|
| 3.6.8 | `POST /_synapse/enhanced/friend/blocks/{user_id}` | 500 | âœ… å·²ä¿®å¤ï¼šblocked_usersè¡¨å·²åˆ›å»º |
| 3.6.9 | `DELETE /_synapse/enhanced/friend/blocks/{user_id}` | 500 | âœ… å·²ä¿®å¤ï¼šblocked_usersè¡¨å·²åˆ›å»º |
| 3.6.14 | `GET /_synapse/enhanced/friend/requests/outgoing` | 500 | æ•°æ®åº“æŸ¥è¯¢é—®é¢˜ |

> âš ï¸ 3.6.8-9 å¾…é‡æ–°æµ‹è¯•éªŒè¯

### 3.7 åª’ä½“æ–‡ä»¶API (7ä¸ªå¤±è´¥)

| # | APIç«¯ç‚¹ | é”™è¯¯ç  | åŸå› åˆ†æ |
|---|---------|--------|----------|
| 3.7.1 | `POST /_matrix/media/v3/upload` | 401 | å­˜å‚¨è·¯å¾„å·²é…ç½®ï¼Œå¾…æµ‹è¯• |
| 3.7.2 | `POST /_matrix/client/r0/voice/upload` | 401 | å­˜å‚¨è·¯å¾„å·²é…ç½®ï¼Œå¾…æµ‹è¯• |
| 3.7.3 | `GET /_matrix/media/v3/download/{server_name}/{media_id}` | 404 | åª’ä½“ä¸å­˜åœ¨ |
| 3.7.4 | `GET /_matrix/media/v3/thumbnail/{server_name}/{media_id}` | 404 | ç¼©ç•¥å›¾ä¸å­˜åœ¨ |
| 3.7.5 | `GET /_matrix/media/v3/preview_url` | 403 | URLé¢„è§ˆæœªå¯ç”¨ |
| 3.7.6 | `DELETE /_matrix/media/v3/config` | 405 | æ–¹æ³•ä¸å…è®¸ |
| 3.7.7 | `GET /_matrix/media/v3/config` | 404 | é…ç½®ç«¯ç‚¹ä¸å­˜åœ¨ |

> ğŸ“ **è¯´æ˜**: åª’ä½“å­˜å‚¨è·¯å¾„å·²é…ç½®ä¸º `/home/hula/synapse_rust/docker/media`ï¼Œéœ€é‡å¯æœåŠ¡æµ‹è¯•

### 3.8 ç§èŠå¢å¼ºAPI (5ä¸ªå¤±è´¥)

| # | APIç«¯ç‚¹ | é”™è¯¯ç  | åŸå› åˆ†æ |
|---|---------|--------|----------|
| 3.8.1 | `POST /_synapse/enhanced/private/sessions` | 500 | ä¼šè¯åˆ›å»ºé€»è¾‘é—®é¢˜ |
| 3.8.2 | `GET /_synapse/enhanced/private/sessions` | 500 | ä¼šè¯æŸ¥è¯¢é€»è¾‘é—®é¢˜ |
| 3.8.3 | `DELETE /_synapse/enhanced/private/sessions/{session_id}` | 404 | ä¼šè¯ä¸å­˜åœ¨ |
| 3.8.4 | `POST /_synapse/enhanced/private/sessions/{session_id}/messages` | 500 | æ¶ˆæ¯å‘é€é€»è¾‘é—®é¢˜ |
| 3.8.5 | `GET /_synapse/enhanced/private/sessions/{session_id}/messages` | 500 | æ¶ˆæ¯æŸ¥è¯¢é€»è¾‘é—®é¢˜ |

### 3.9 å¯†é’¥å¤‡ä»½API (1ä¸ªå¤±è´¥)

| # | APIç«¯ç‚¹ | é”™è¯¯ç  | åŸå› åˆ†æ |
|---|---------|--------|----------|
| 3.9.10 | `GET /_matrix/client/v3/room_keys/keys/{room_id}` | 404 | ä¼šè¯å¯†é’¥ä¸å­˜åœ¨ |

---

## ğŸ”§ å¾…éªŒè¯ä¿®å¤ (é‡æ–°æµ‹è¯•)

ä»¥ä¸‹æµ‹è¯•å·²ä¿®å¤ï¼Œéœ€é‡æ–°è¿è¡Œæµ‹è¯•è„šæœ¬éªŒè¯ï¼š

```bash
# é‡æ–°ç¼–è¯‘å¹¶å¯åŠ¨æœåŠ¡
cd /home/hula/synapse_rust
cargo build --release
docker-compose restart synapse-rust

# è¿è¡Œæµ‹è¯•
./test_api_311.sh          # å®¢æˆ·ç«¯APIæµ‹è¯•
./test_admin_apis_v2.sh    # ç®¡ç†å‘˜APIæµ‹è¯•
./test_friend_features.sh  # å¥½å‹åŠŸèƒ½æµ‹è¯•
```

---

## ğŸ“‹ å¾…é…ç½®é¡¹

| é¡¹ç›® | é…ç½®è·¯å¾„ | çŠ¶æ€ |
|------|----------|------|
| åª’ä½“å­˜å‚¨ | `/home/hula/synapse_rust/docker/media` | âœ… å·²é…ç½® |
| è¯­éŸ³å­˜å‚¨ | `/home/hula/synapse_rust/docker/media/voice` | âœ… å·²é…ç½® |

---

## ğŸ“ˆ ä¿®å¤è¿›åº¦

- **æ€»æµ‹è¯•æ•°**: 170
- **å·²é€šè¿‡**: 139
- **å¾…ä¿®å¤**: 31
- **å·²ä¿®å¤å¾…éªŒè¯**: 7 (3.2.18-19, 3.4.6, 3.5.1, 3.6.8-9)
- **éœ€é…ç½®å­˜å‚¨**: 2 (3.7.1-2)
- **æœªå®ç°åŠŸèƒ½**: 6 (è”é‚¦API)
- **é€»è¾‘é—®é¢˜**: 16

**é¢„è®¡ä¿®å¤åé€šè¿‡ç‡**: 91% (155/170)

---

*æ–‡æ¡£æ›´æ–°æ—¶é—´: 2026-02-06 17:00:00*
