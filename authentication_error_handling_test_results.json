{
  "test_time": "2026-02-04 11:10:29",
  "base_url": "http://localhost:8008",
  "total_tests": 16,
  "passed_tests": 16,
  "failed_tests": 0,
  "success_rate": "100.00%",
  "test_results": [
    {
      "test": "使用有效Token访问whoami接口",
      "endpoint": "/_matrix/client/r0/account/whoami",
      "method": "GET",
      "expected_status": 200,
      "actual_status": 200,
      "success": true,
      "response": {
        "admin": false,
        "avatar_url": null,
        "displayname": "testuser2",
        "user_id": "@testuser2:matrix.cjystx.top"
      }
    },
    {
      "test": "使用无效Token访问whoami接口",
      "endpoint": "/_matrix/client/r0/account/whoami",
      "method": "GET",
      "expected_status": 401,
      "actual_status": 401,
      "success": true,
      "response": {
        "errcode": "M_UNAUTHORIZED",
        "error": "Invalid token: InvalidToken"
      }
    },
    {
      "test": "不携带Token访问whoami接口",
      "endpoint": "/_matrix/client/r0/account/whoami",
      "method": "GET",
      "expected_status": 401,
      "actual_status": 401,
      "success": true,
      "response": {
        "errcode": "M_UNAUTHORIZED",
        "error": "Missing or invalid authorization header"
      }
    },
    {
      "test": "使用管理员Token访问server_version接口",
      "endpoint": "/_synapse/admin/v1/server_version",
      "method": "GET",
      "expected_status": 200,
      "actual_status": 200,
      "success": true,
      "response": {
        "python_version": "3.9.0",
        "version": "1.0.0"
      }
    },
    {
      "test": "使用普通用户Token访问server_version接口",
      "endpoint": "/_synapse/admin/v1/server_version",
      "method": "GET",
      "expected_status": 403,
      "actual_status": 403,
      "success": true,
      "response": {
        "errcode": "M_FORBIDDEN",
        "error": "Admin access required"
      }
    },
    {
      "test": "验证错误响应格式",
      "endpoint": "/_matrix/client/r0/account/whoami",
      "method": "GET",
      "expected_status": 401,
      "actual_status": 401,
      "success": true,
      "response": {
        "errcode": "M_UNAUTHORIZED",
        "error": "Invalid token: InvalidToken"
      }
    },
    {
      "test": "测试200状态码",
      "endpoint": "/_matrix/client/r0/account/whoami",
      "method": "GET",
      "expected_status": 200,
      "actual_status": 200,
      "success": true,
      "response": {
        "admin": false,
        "avatar_url": null,
        "displayname": "testuser2",
        "user_id": "@testuser2:matrix.cjystx.top"
      }
    },
    {
      "test": "测试400状态码（缺少必需参数）",
      "endpoint": "/_matrix/client/r0/login",
      "method": "POST",
      "expected_status": 400,
      "actual_status": 400,
      "success": true,
      "response": {
        "errcode": "M_BAD_JSON",
        "error": "Username required"
      }
    },
    {
      "test": "测试401状态码",
      "endpoint": "/_matrix/client/r0/account/whoami",
      "method": "GET",
      "expected_status": 401,
      "actual_status": 401,
      "success": true,
      "response": {
        "errcode": "M_UNAUTHORIZED",
        "error": "Invalid token: InvalidToken"
      }
    },
    {
      "test": "测试403状态码（普通用户访问管理员API）",
      "endpoint": "/_synapse/admin/v1/server_version",
      "method": "GET",
      "expected_status": 403,
      "actual_status": 403,
      "success": true,
      "response": {
        "errcode": "M_FORBIDDEN",
        "error": "Admin access required"
      }
    },
    {
      "test": "测试404状态码（访问不存在的房间）",
      "endpoint": "/_matrix/client/r0/rooms/!invalidroomid:server.com/state/m.room.name",
      "method": "GET",
      "expected_status": 404,
      "actual_status": 404,
      "success": true,
      "response": {
        "errcode": "M_NOT_FOUND",
        "error": "Room '!invalidroomid:server.com' not found"
      }
    },
    {
      "test": "测试M_UNAUTHORIZED错误码",
      "endpoint": "/_matrix/client/r0/account/whoami",
      "method": "GET",
      "expected_status": 401,
      "actual_status": 401,
      "success": true,
      "response": {
        "errcode": "M_UNAUTHORIZED",
        "error": "Invalid token: InvalidToken"
      }
    },
    {
      "test": "测试M_NOT_FOUND错误码",
      "endpoint": "/_matrix/client/r0/rooms/!invalidroomid:server.com/state/m.room.name",
      "method": "GET",
      "expected_status": 404,
      "actual_status": 404,
      "success": true,
      "response": {
        "errcode": "M_NOT_FOUND",
        "error": "Room '!invalidroomid:server.com' not found"
      }
    },
    {
      "test": "测试M_BAD_JSON错误码",
      "endpoint": "/_matrix/client/r0/login",
      "method": "POST",
      "expected_status": 400,
      "actual_status": 400,
      "success": true,
      "response": {
        "errcode": "M_BAD_JSON",
        "error": "Username required"
      }
    },
    {
      "test": "测试M_FORBIDDEN错误码",
      "endpoint": "/_synapse/admin/v1/server_version",
      "method": "GET",
      "expected_status": 403,
      "actual_status": 403,
      "success": true,
      "response": {
        "errcode": "M_FORBIDDEN",
        "error": "Admin access required"
      }
    },
    {
      "test": "测试M_MISSING_PARAM错误码",
      "endpoint": "/_matrix/client/r0/login",
      "method": "POST",
      "expected_status": 400,
      "actual_status": 400,
      "success": true,
      "response": {
        "errcode": "M_BAD_JSON",
        "error": "Username required"
      }
    }
  ]
}